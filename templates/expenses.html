{% extends 'base.html' %}
{% block content %}

<h2>Expenses</h2>

<!-- ================= ADD EXPENSE ================= -->
<div class="card">
    <h3>Add Expense</h3>

    <form method="POST" action="{{ url_for('add_expense') }}" class="expense-form">

        <input type="text" name="title" placeholder="Expense title" required>

        <input type="text" name="category" placeholder="Category (Rent, Salary, Fuel...)" required>

        <input type="number" step="0.01" name="amount" placeholder="Amount (₹)" required>

        <select name="payment_mode">
            <option value="">Payment Mode</option>
            <option>Cash</option>
            <option>UPI</option>
            <option>Bank Transfer</option>
            <option>Card</option>
        </select>

        <input type="date" name="expense_date" required>

        <input type="text" name="reference" placeholder="Reference / Bill No">

        <input type="text" name="notes" placeholder="Notes (optional)">

        <button type="submit">Add Expense</button>
    </form>
</div>

<hr>

<!-- ================= EXPENSE LIST ================= -->
<h3>All Expenses</h3>

{% if expenses %}
<table class="expense-table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Title</th>
            <th>Category</th>
            <th>Amount</th>
            <th>Mode</th>
            <th>Reference</th>
            <th>Notes</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
    {% for e in expenses %}
        <tr>
            <td>{{ e.expense_date.strftime('%d-%m-%Y') }}</td>
            <td>{{ e.title }}</td>
            <td>{{ e.category }}</td>
            <td>₹{{ "{:,.2f}".format(e.amount).replace(",", "_").replace("_", ",", 1) }}</td>
            <td>{{ e.payment_mode }}</td>
            <td>{{ e.reference or '-' }}</td>
            <td>{{ e.notes or '-' }}</td>
            <td>
                <form method="POST" action="{{ url_for('delete_expense', id=e.id) }}" onsubmit="return confirm('Delete this expense?')">
                    <button class="danger">Delete</button>
                </form>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p>No expenses recorded yet.</p>
{% endif %}

<style>
.card {
    background: #fff;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

.expense-form {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.expense-form input, .expense-form select {
    padding: 6px;
}

.expense-form button {
    grid-column: span 4;
    padding: 8px;
    background: #007bff;
    color: #fff;
    border: none;
    cursor: pointer;
}

.expense-table {
    width: 100%;
    border-collapse: collapse;
}

.expense-table th, .expense-table td {
    border: 1px solid #ccc;
    padding: 6px;
    text-align: center;
}

.danger {
    background: #dc3545;
    color: #fff;
    border: none;
    padding: 4px 8px;
    cursor: pointer;
}
</style>

{% endblock %}
